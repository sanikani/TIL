# 데이터 무결성(Data Integrity)
데이터 무결성이란 데이터 값이 정확한 상태를 의미한다. 무결성을 지키는 것이 데이터 모델링의 최고 목표이다.
# 데이터 정합성
어떤 데이터들이 값이 서로 일치하는 상태를 의미한다.
비정규형을 사용해 이상현상(anomaly)이 발생하면 정합성이 지켜지지 않는다.
# 무결성과 정합성의 예시
정합성은 지켜지지만 무결성이 지켜지지 않는 경우가 있다.
**예시**

**무결성 훼손 예시**

상품 테이블에서 가격이 -1000이고, 구매정보 테이블에서도 -1000의 값을 갖는 상품이 존재한다. 이는 데이터의 값이 일치하기 때문에 데이터 정합성은 이상이 없으나, 가격은 반드시 0 이상의 값을 가져야 하기 때문에 데이터 무결성이 훼손되었다고 볼 수 있다.

**정합성 훼손 예시**

위 예시에서 상품 테이블의 가격을 1000으로 변경했지만, 구매정보 테이블에서는 가격이 변경되지 않았을 때 데이터 정합성이 훼손되었다고 볼 수 있다.

## 데이터 무결성의 종류

데이터 무결성은 실체 무결성, 영역 무결성, 참조 무결성, 사용자 정의 무결성이 있다.

### 실체 무결성(Entity Integrity)

- 모든 인스턴스는 고유한 값 또는 NULL 값을 가지지 않는 속성이나 속성 그룹을 가져야 한다.
- 실체 무결성은 식별자(Identifier)에 의해서 지켜질 수 있다.
- PK 제약조건과 Unipue 제약조건 등을 이용하여 보장하는 것이 좋다.
- PK 제약
    - 데이터베이스에서 가장 중요한 무결성 조건으로 식별자 값은 NOT NULL이고 UNIQUE해야 한다. PK가 없는 테이블 운영은 데이터 조작 시 이상 현상이 발생하거나 조인에 의해 집계된 금액이 잘못 계산될 가능성이 높다.
- UNIQUE 제약
    - 실체 무결성은 UNIQUE column도 대상이다. 상품 테이블에서 상품 코드가 PK이고 업무 요건에 의해서 상품 바코드도 유일한 값을 가져야 한다면 실체 무결성을 위해 상품 바고드에 UNIQUE 제약 조건을 적용해야 한다.

### 영역 무결성(Domain Integrity)

- column의 데이터 타입, 길이, 유효 값, 널 여부, 기본값 등이 일관되게 유지되어야 한다.
- 영역 무결성은 기본 값이나 널 여부, 체크 조건 등으로 지켜질 수 있다.

### 참조 무결성(Referential Intergrity)

- Entity의 외래 식별자 속성은 참조되는 Entity의 주 식별자 값과 일치하거나 NULL값이어야 한다.
- 참조 무결성은 외래 키 제약조건에 의해서 지켜진다.
- 참조 무결성은 두 실체 사이의 관계 규칙을 정의하기 위한 제약 조건으로 데이터가 입력, 수정 삭제될 때 두 실체의 튜플들 사이의 정합성과 일관성을 유지하는데 사용된다. 참조 무결성 제약조건은 어떤 실체의 튜플이 다른 실체에 있는 튜플을 참조하려면 참조되는 튜플이 반드시 그 실체 내에 존재하여야 한다는 것이다.

<aside>
💡 튜플은 테이블을 구성하는 데이터들 중 가로로 묶은 데이터셋을 의미한다. 일반적으로 행은 한 객체에 대한 정보를 가지고 있다.

</aside>

### 사용자 정의 무결성(Business Integrity)

- 기업에서 업무를 수행하는 방법이나 데이터를 처리하는 규칙을 의미한다.
- 사용자 정의 무결성을 물리적으로 강제하는 대표적인 방법에 트리거가 존재한다.